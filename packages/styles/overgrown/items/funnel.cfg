"Conditions"
	{
	"Condition"
		{
		"Priority" "-300"
		"instance" "<ITEM_TBEAM:fun_emitter>"
		"Result"
			{
			"ChangeIOType"
				{
				// Particles 
				"Enable_Cmd"		"tbeam,RunScriptCode,SetActive(true),0.00,-1"
				"Disable_Cmd"		"tbeam,RunScriptCode,SetActive(false),0.00,-1"
				"Sec_Enable_Cmd"	"tbeam,RunScriptCode,SetReverse(true),0.00,-1"
				"Sec_Disable_Cmd"	"tbeam,RunScriptCode,SetReverse(false),0.00,-1"
				
				// Matches Clean
				"Type"              "DUAL"
				"Init"              "Auto"
				"DefaultDual"       "A"
				"InvertVar"         "$start_enabled"
				"Enable_Cmd"        "tbeam,Enable,,0.00,-1"
				"Disable_Cmd"       "tbeam,Disable,,0.00,-1"
				
				"Sec_InvertVar"     "$start_reversed"
				"Sec_Enable_Cmd"    "tbeam,SetLinearForce,$neg_force,0.00,-1"
				"Sec_Enable_Cmd"    "mat_mod,StartFloatLerp,0 1 0.5 0,0.00,-1"
				"Sec_Enable_Cmd"    "light_o,TurnOn,,0.00,-1"
				"Sec_Enable_Cmd"    "light_b,TurnOff,,0.00,-1"
				
				"Sec_Disable_Cmd"   "tbeam,SetLinearForce,$pos_force,0.00,-1"
				"Sec_Disable_Cmd"   "mat_mod,StartFloatLerp,1 0 0.5 0,0.00,-1"
				"Sec_Disable_Cmd"   "light_o,TurnOff,,0.00,-1"
				"Sec_Disable_Cmd"   "light_b,TurnOn,,0.00,-1"
				}

			// Attach particles to the arms.
			"GlobalInput" "pb1,SetParentAttachment,emitter1,0,1"
			"GlobalInput" "pb2,SetParentAttachment,emitter2,0,1"
			"GlobalInput" "pb3,SetParentAttachment,emitter3,0,1"
			"GlobalInput" "po1,SetParentAttachment,emitter1,0,1"
			"GlobalInput" "po2,SetParentAttachment,emitter2,0,1"
			"GlobalInput" "po3,SetParentAttachment,emitter3,0,1"
			}
		"Condition"
			{
			"StyleVar" "OverFunnelFlicker"
			"Result"
				{
				"SetInstVar" "$start_disabled !$start_enabled"
				"AddOverlay" "instances/BEE2/over/items/tbeam_flicker.vmf"
				"ChangeIOType"
					{
					// Flickering 
					"Enable_Cmd"		"error*,Enable,,0.00,-1"
					"Disable_Cmd"		"error*,Disable,,0.00,-1"
					"Disable_Cmd"		"error_rl,CancelPending,,0.00,-1"

					// Particles 
					"Enable_Cmd"		"tbeam,RunScriptCode,SetActive(true),0.00,-1"
					"Disable_Cmd"		"tbeam,RunScriptCode,SetActive(false),0.00,-1"
					"Sec_Enable_Cmd"	"tbeam,RunScriptCode,SetReverse(true),0.00,-1"
					"Sec_Disable_Cmd"	"tbeam,RunScriptCode,SetReverse(false),0.00,-1"
					
					// Matches Clean
					"Type"              "DUAL"
					"Init"              "Auto"
					"DefaultDual"       "A"
					"InvertVar"         "$start_enabled"
					"Enable_Cmd"        "tbeam,Enable,,0.00,-1"
					"Disable_Cmd"       "tbeam,Disable,,0.00,-1"
					
					"Sec_InvertVar"     "$start_reversed"
					"Sec_Enable_Cmd"    "tbeam,SetLinearForce,$neg_force,0.00,-1"
					"Sec_Enable_Cmd"    "mat_mod,StartFloatLerp,0 1 0.5 0,0.00,-1"
					"Sec_Enable_Cmd"    "light_o,TurnOn,,0.00,-1"
					"Sec_Enable_Cmd"    "light_b,TurnOff,,0.00,-1"
					
					"Sec_Disable_Cmd"   "tbeam,SetLinearForce,$pos_force,0.00,-1"
					"Sec_Disable_Cmd"   "mat_mod,StartFloatLerp,1 0 0.5 0,0.00,-1"
					"Sec_Disable_Cmd"   "light_o,TurnOff,,0.00,-1"
					"Sec_Disable_Cmd"   "light_b,TurnOn,,0.00,-1"
					}
				}
			}
		}
	"Condition"
		{
		"instance" "<ITEM_TBEAM:fun_emitter>"
		"OR"
			{
			"instvar" "$conn_count_b > 0"
			"instvar" "$start_reversed 1"
			}
		"Result"
			{
			// Overgrown still has the extra particles in this instance
			"AddOverlay" "instances/BEE2/over/items/tbeam_polarity.vmf"
			}
		}
	}
