"Conditions"
	{
	"Condition"  
		{ 
		"instance"  "<ITEM_REX_PELLET_FIELD:fizz_base>"  
		"Condition"
			{
			"OR"
				{
				"instvar" "timer_delay > 30"
				"instvar" "timer_delay 0"
				}
			"Result"
				{
				"suffix" "toggle"
				"SetInstVar" "$is_toggle 1"
				}
			"Else"
				{
				"suffix" "timer"
				"TimedRelay"
					{
					"variable"      "$timer_delay"
					"targetname"    "delay_rl"
					"RepOutputs"
						{
						"OnTrigger" "out,PlaySound,,0,-1"
						}
					"FinalOutputs"
						{
						"OnTrigger" "repeat_branch,SetValue,0,0,-1"
						"OnTrigger" "out,FireUser1,,0,-1"
						"OnTrigger" "mdl,Color,0 200 0,0,-1"
						}
					}
				
				"SetInstVar" "$is_toggle 0"
				}
			}
		"Result"
			{
			"Pack"  "PACK_BEE2_CUST_FIZZ_MDL"
			"Pack"  "PACK_REX_PELLET_FIELD"
			"Has"
				{
				"Fizzler"           "1"
				"RexPelletField"    "1"
				}
			"CustFizzler"
				{
				"UniqueModel"   "0"
				"MergeBrushes"  "1"
				"Brush"
					{
					"Name"      "fizz"
					"Left"      "tools/toolstrigger"
					"Center"    "tools/toolstrigger"
					"Right"     "tools/toolstrigger"
					"Short"     "tools/toolstrigger"
					"Nodraw"    "tools/toolstrigger"
					"Keys"
						{
						"classname"     "trigger_multiple"
						"Spawnflags"    "64" // Everything
						"filtername"    "@filter_pellet"
						}
					"Outputs"
						{
						"OnStartTouch"  "out,FireUser4,,0,-1"
						"OnStartTouch"  "tes,DoSpark,,0,-1"
						}
					}
				}
			"GlobalInput"
				{
				// This function teleports the tesla to the pellet just before DoSpark activates.
				"input"  "RunScriptCode"
				"param"  "function InputDoSpark() { self.SetAbsOrigin(activator.GetOrigin());return 1;}"
				"target" "tes"
				}
			}
		}
	"Condition"  
		{
		"instance"  "<ITEM_REX_PELLET_FIELD:fizz_model>"
		"Condition"
			{
			"instvar" "$is_toggle 1"
			"Result"
				{
				"FizzlerModelPair"
					{
					"uniqueName"    "0"
					"StartInst"     "instances/BEE2/clean/items/rex/pellet_field_model_toggle.vmf"
					"EndInst"       "instances/BEE2/clean/items/rex/pellet_field_model_toggle.vmf"
					
					// Shrink the length so the curve fits in the space..
					"SingleInst"    "instances/BEE2/clean/items/rex/pellet_field_model_toggle_short.vmf"
					
					"SingleBrush"   "1"
					"StartTemp"     "REX_PELLET_FIELD:toggle_side"
					"EndTemp"       "REX_PELLET_FIELD:toggle_side"
					"SingleTemp"    "REX_PELLET_FIELD:toggle_single"
					"BrushKeys"
						{
						"classname"  "func_brush"
						"solidity"   "1"  // Never solid
						"spawnflags" "1" // No +use output
						}
					"LocalBrushKeys"
						{
						"targetname" "field"
						}
					}
				}
			"Else" // Timer
				{
				"FizzlerModelPair"
					{
					"uniqueName"    "0"
					"StartInst"     "instances/BEE2/clean/items/rex/pellet_field_model_timer.vmf"
					"EndInst"       "instances/BEE2/clean/items/rex/pellet_field_model_timer.vmf"
					
					// Shrink the length so the curve fits in the space..
					"SingleInst"    "instances/BEE2/clean/items/rex/pellet_field_model_timer_short.vmf"
					
					"StartTemp"     "REX_PELLET_FIELD:timer_side"
					"EndTemp"       "REX_PELLET_FIELD:timer_side"
					"SingleTemp"    "REX_PELLET_FIELD:timer_single"
					"SingleBrush"   "1"
					"BrushKeys"
						{
						"classname"  "func_brush"
						"solidity"   "1"  // Never solid
						"spawnflags" "1" // No +use output
						}
					// No name, doesn't change
					}
				}
			}
		}
	}
